{% set identifiers = doc.pod.podspec.meta.get('responsive_styles', {}).get('media_queries', {}) %}

{%- macro responsive_style(attributes_to_styles) -%}
  {%- if attributes_to_styles -%}
    <style scoped>
    {%- for attribute, styles in attributes_to_styles.iteritems() -%}
      {%- for identifiers_to_styles in styles %}
        {%- for identifier, style in identifiers_to_styles.iteritems() -%}
          {% set query = identifiers.get(identifier, identifier) %}
          @media {{query}} {
            [{{attribute}}] {
              {{style}}
            }
          }
        {%- endfor -%}
      {%- endfor -%}
    {%- endfor -%}
    </style>
  {%- endif -%}
{%- endmacro -%}

{%- macro render_responsive_styles() -%}
  {% set attributes_to_styles = get_attribute_cache() %}
  {{responsive_style(attributes_to_styles)}}
{%- endmacro -%}
